#!/usr/bin/perl

if ($ARGV[0] and $ARGV[0] eq "config") {
  print <<EOM
graph_category catlady
graph_title Catlady memory usage
graph_vlabel memory
graph_args --base 1024
vsize.label vsize
vsize.type GAUGE
vsize.draw AREA
vsize.min 0
rss.label rss
rss.type GAUGE
rss.draw LINE2
rss.min 0
EOM
  ;
  exit 0;
}

my ($line) = split "\n", qx{ps -ao rss,vsize,args|grep \'catlady$\'};
my ($rss, $vsize) = $line =~ /^(\d+)\s*(\d+)/;
$rss *= 1000;
$vsize *= 1000;

print "vsize.value $vsize\n";
print "rss.value $rss\n";
